var T=Object.create;var m=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var W=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var B=(e,r,t,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of E(r))!x.call(e,n)&&n!==t&&m(e,n,{get:()=>r[n],enumerable:!(s=k(r,n))||s.enumerable});return e};var i=(e,r,t)=>(t=e!=null?T(W(e)):{},B(r||!e||!e.__esModule?m(t,"default",{value:e,enumerable:!0}):t,e));var v=require("electron");var d=i(require("electron"));function g(){let e=["content-security-policy"];d.default.session.defaultSession.webRequest.onHeadersReceived((r,t)=>{Object.keys(r.responseHeaders).forEach(s=>{e.includes(s.toLowerCase())&&delete r.responseHeaders[s]}),r.responseHeaders["Access-Control-Allow-Origin"]=["*"],t({cancel:!1,responseHeaders:r.responseHeaders})}),d.default.session.defaultSession.webRequest.onBeforeSendHeaders((r,t)=>{r.requestHeaders.Origin="*",t({requestHeaders:r.requestHeaders})})}var o=require("electron");function y(){o.ipcMain.on("GetPath",(e,r)=>{if(r==="appPath"){e.returnValue=o.app.getAppPath();return}try{e.returnValue=o.app.getPath(r)}catch{e.returnValue=null}}),o.ipcMain.on("Relaunch",()=>{o.app.quit(),o.app.relaunch()}),o.ipcMain.on("DevTools:Open",(e,r)=>{try{e.sender.openDevTools({mode:r,activate:!0})}catch{}}),o.ipcMain.on("DevTools:Close",e=>{try{e.sender.closeDevTools()}catch{}}),o.ipcMain.on("DevTools:Toggle",(e,r)=>{try{e.sender.isDevToolsOpened()?e.sender.closeDevTools():e.sender.openDevTools({mode:r,activate:!0})}catch{}}),o.ipcMain.on("RegisterPreload",(e,r)=>{try{o.app.commandLine.appendSwitch("preload",r)}catch{}}),o.ipcMain.handle("ExecuteWindowScript",async(e,r)=>{try{return{ok:!0,data:await e.sender.executeJavaScript(`(() => {try {${r}} catch {}})();`,!0)}}catch(t){return{ok:!1,error:`${t}`}}}),o.ipcMain.handle("ExecuteInjectorScript",async(event,arg)=>{try{let res=await eval(`(() => {try {${arg}} catch {}})();`);return{ok:!0,data:res}}catch(e){return{ok:!1,error:`${e}`}}}),o.ipcMain.handle("ShowDialog",async(e,{mode:r="open",openDirectory:t=!1,openFile:s=!0,multiSelections:n=!1,filters:a,promptToCreate:h=!1,defaultPath:c,title:b,showOverwriteConfirmation:D,message:_,showHiddenFiles:H,modal:C=!1}={})=>{let w={open:o.dialog.showOpenDialog,save:o.dialog.showSaveDialog}[r];return w?{ok:!1,data:w.apply(o.dialog,[C&&o.BrowserWindow.fromWebContents(e.sender),{defaultPath:c,filters:a,title:b,message:_,createDirectory:!0,properties:[H&&"showHiddenFiles",t&&"openDirectory",h&&"promptToCreate",t&&"openDirectory",s&&"openFile",n&&"multiSelections",D&&"showOverwriteConfirmation"].filter(l=>l)}].filter(l=>l))}:{error:"Invalid mode.",ok:!1}}),o.ipcMain.handle("ShowWindow",(e,{url:r="",options:t=null,closeOnUrl:s=""}={})=>new Promise(n=>{let a=new o.BrowserWindow(t);if(a.loadURL(r),a.webContents.on("did-navigate",(h,c)=>{c==s&&(windowInstance.close(),n(a.id))}),!s)return n(a.id)}))}var P=i(require("electron"));function O(){P.default.session.fromPartition("default").setPermissionRequestHandler((e,r,t)=>{t(!0)})}var p=i(require("electron")),u=i(require("path")),f=i(require("fs"));function S(){class e extends p.default.BrowserWindow{constructor(t){if(!t||!t.webPreferences||!t.webPreferences.preload||!t.title)return super(t);let s=t.webPreferences.preload;t.webPreferences.preload=u.default.join(__dirname,"preload.js"),super(t),this.__originalPreload=s,this.webContents.on("dom-ready",async()=>{let n=u.default.join(__dirname,"renderer.js");if(!f.default.existsSync(n))return;let a=f.default.readFileSync(n,"utf-8");this.webContents.executeJavaScript(`(() => { try { ${a} return true; } catch (error) { console.error(error); return false; } })();`)}),this.webContents.on("did-navigate-in-page",()=>{this.webContents.send("NavigateInPage")})}}Object.assign(e,p.default.BrowserWindow)}process.argv.includes("--original")||(process.env.NODE_OPTIONS="--no-force-async-hooks-checks",v.app.commandLine.appendSwitch("no-force-async-hooks-checks"),O(),g(),y());try{let e;Object.defineProperty(global,"appSettings",{get(){return e},set(r){r.hasOwnProperty("settings")||(r.settings={}),r.settings.DANGEROUS_ENABLE_DEVTOOLS_ONLY_ENABLE_IF_YOU_KNOW_WHAT_YOURE_DOING=!0,e=r}})}catch{}process.argv.includes("--original")||S();
